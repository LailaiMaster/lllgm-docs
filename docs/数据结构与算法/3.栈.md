# 如何理解栈

![图片](https://uploader.shimo.im/f/uzszf2E0WJYPWu2s.png!thumbnail)

先进后出，从操作上看，栈像是一种**受限操作**的线性表，只允许一段插入和删除数据。

从功能上，数组或链表完全可以替代掉栈，但是，特定的数据结构是对特定场景的抽象，栈局限的操作，减少了出错的可能。

**当一个数据集合只涉及一段插入和删除，并满足后进先出、先进后出的特性，就首选栈数据结构**。

栈的操作包括，出栈和入栈。可以用数组和链表实现，数组实现的叫顺序栈，链表实现的叫链式栈。出栈入栈的时间复杂度O(1)。

# 应用

## 栈在函数调用中的应用

操作系统为每个线程分配了一个独立的内存空间，这块内存空间被组织成栈结构，用来存储函数调用的临时变量。每调用进入一个函数，就会将临时变量作为一个栈帧入栈，当被调用的函数执行完，就将这个函数的对应栈帧出栈。

```
int main() {
   int a = 1; 
   int ret = 0;
   int res = 0;
   ret = add(3, 5);
   res = a + ret;
   printf("%d", res);
   reuturn 0;
}
 
int add(int x, int y) {
   int sum = 0;
   sum = x + y;
   return sum;
}
```
![图片](https://uploader.shimo.im/f/2InbwiEWuQ8j28Aq.png!thumbnail)

## 编译器如何四则运算

通过两个栈实现，一个操作数栈，一个运算符栈。

从左到右遍历运算符，遇到操作数就放入操作数栈，遇到运算符就放入运算符栈。

运算符栈入栈时，

当当前运算符的优先级高于栈顶运算符，就直接入栈。

当前运算符的**优先级低于或者相同栈顶运算符时**，就从栈顶取出两个操作数，进行计算，把计算结果压入操作数栈。

如 3+5*8-6。

![图片](https://uploader.shimo.im/f/VH7JCYdoRL8NlTnw.png!thumbnail)

## 检查表达式括号是否匹配

表达式有三种括号() [] {}，可以任意嵌套，检查是否合法。

如（{([ [])}）}

用栈来保存未匹配的左括号，依次从左到右扫描，当扫描到右括号时，从栈顶取出一个左括号，如果匹配，就继续扫描，不匹配说明是非法格式。

当所有括号都扫描完成，如果栈为空，说明合法，不为空，说明有非匹配的左括号。



